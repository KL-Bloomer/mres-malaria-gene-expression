citation()
citation(package = "gplots")
citation(package="ggplot2")
library(tidyr)
library(stringr)
library(dplyr)
library(data.table)
#Creating files for the different clusters and a file with no genes from the clusters
setwd('~/MRes_Malaria_2021/output/mres-malaria-gene-expression/R_output/RNA-seq_tables/')
clusters <- fread('clusters_scaled_8clusters_20May.txt')
View(clusters)
cluster_ids <- unique(clusters$groups)
setwd('~/MRes_Malaria_2021/output/mres-malaria-gene-expression/ref')
GFF<- fread(cmd= 'grep -v "^#" PlasmoDB-49_PbergheiANKA.gff')
gff <- separate(data = GFF, col = V9, into = c("Geneid_Feature"), sep = "([;])")
gff <- gff %>%
mutate_at("Geneid_Feature", str_replace, "ID=", "")
gff[, V4 := ifelse(V7 == '-', V5, V4)]
gff[, V5 := V4]
setnames(gff, "Geneid_Feature", "gene_id")
setnames(gff, "V1", "#V1")
for (clst in cluster_ids) {
gff[gff$gene_id %in% clusters[cluster_id == clst]$gene_id]
}
for (clst in cluster_ids) {
gff[gff$gene_id %in% clusters[cluster_ids == clst]$gene_id]
}
cluster_ids <- clusters$groups
for (clst in cluster_ids) {
gff[gff$gene_id %in% clusters[cluster_ids == clst]$gene_id]
}
unique_ids <- unique(clusters$groups)
for (clst in cluster_ids) {
for (unique in unique_ids)
GFF_clst[unique_ids == unique] <- gff[gff$gene_id %in% clusters[cluster_ids == clst]$gene_id]
}
cluster_ids <- clusters$groups
unique_ids <- unique(clusters$groups)
for (clst in cluster_ids) {
for (unique in unique_ids)
GFF_clst[unique_ids == unique] <- gff[gff$gene_id %in% clusters[cluster_ids == clst]$gene_id]
}
cluster_ids <- clusters$groups
unique_ids <- unique(clusters$groups)
for (clst in cluster_ids) {
for (unique in unique_ids)
GFF_clst[unique_ids == unique] = gff[gff$gene_id %in% clusters[cluster_ids == clst]$gene_id]
}
for (clst in cluster_ids) {
for (unique in unique_ids)
clusters[unique_ids == unique] <- gff[gff$gene_id %in% clusters[cluster_ids == clst]$gene_id]
}
for (clst in cluster_ids) {
for (unique in unique_ids)
clusters(unique[cluster_ids == clst]) <- gff[gff$gene_id %in% clusters[cluster_ids == clst]$gene_id]
}
for (clst in cluster_ids) {
for (unique in unique_ids)
clusters(unique[cluster_ids == clst]$gene_id) <- gff[gff$gene_id %in% clusters[cluster_ids == clst]$gene_id]
}
unique[cluster_ids == clst]
clusters[unique_ids == unique]
for (clst in cluster_ids) {
sample <- gff[gff$gene_id %in% clusters[cluster_ids == clst]$gene_id]
}
View(sample)
for (clst in cluster_ids) {
sample <- gff[gff$gene_id %in% clusters[cluster_ids == clst]$gene_id]
write.table(sample, file=paste("clst_",row.names = FALSE, sep= '\t', quote= FALSE))
}
setwd('~/MRes_Malaria_2021/git_repos/mres-malaria-gene-expression/Tables/')
cluster_ids <- clusters$groups
unique_ids <- unique(clusters$groups)
for (clst in cluster_ids) {
sample <- gff[gff$gene_id %in% clusters[cluster_ids == clst]$gene_id]
write.table(sample, file=paste("clst_",row.names = FALSE, sep= '\t', quote= FALSE))
}
cluster_ids <- unique(clusters$groups)
for (clst in cluster_ids) {
clst_genes <- clusters[groups == clst]$gene_id
sample <- gff[gene_id %in% clst_genes]
write.table(sample, file=paste("clst", clst, ".gff", sep =''), row.names = FALSE, col.names = FALSE, sep= '\t', quote= FALSE)
}
clstnot <- allgenes_table[!allgenes_table$gene_id %in% clusters$gene_id]
GFF_not <- gff[gff$Geneid_Feature %in% clstnot$gene_id]
write.table(GFF_not, file="clstnot.gff", row.names = FALSE, sep= '\t', quote= FALSE)
#Creating files for the different clusters and a file with no genes from the clusters
setwd('~/MRes_Malaria_2021/output/mres-malaria-gene-expression/R_output/RNA-seq_tables/')
clusters <- fread('clusters_scaled_8clusters_20May.txt')
allgenes_table <- fread('gene_id_desc_table (1)')
clstnot <- allgenes_table[!allgenes_table$gene_id %in% clusters$gene_id]
GFF_not <- gff[gff$Geneid_Feature %in% clstnot$gene_id]
write.table(GFF_not, file="clstnot.gff", row.names = FALSE, sep= '\t', quote= FALSE)
all_genes_gff <- gff[gff$Geneid_Feature %in% allgenes_table$gene_id]
setnames(all_genes_gff, "Geneid_Feature", "gene_id")
setnames(all_genes_gff, "V1", "#V1")
for (clst in cluster_ids){
clst_genes <- clusters[groups == clst]$gene_id
neg_clst_genes <- all_genes_gff[!all_genes_gff$gene_id %in% clst_genes]
write.table(neg_clst_genes, file=paste("neg_clst", clst, ".gff", sep =''), row.names = FALSE, col.names = FALSE, sep= '\t', quote= FALSE)
}
all_genes_gff <- gff[gff$Geneid_Feature %in% allgenes_table$gene_id]
all_genes_gff <- gff[gff$gene_id %in% allgenes_table$gene_id]
View(all_genes_gff)
for (clst in cluster_ids){
clst_genes <- clusters[groups == clst]$gene_id
neg_clst_genes <- all_genes_gff[!all_genes_gff$gene_id %in% clst_genes]
write.table(neg_clst_genes, file=paste("neg_clst", clst, ".gff", sep =''), row.names = FALSE, col.names = FALSE, sep= '\t', quote= FALSE)
}
setwd('~/MRes_Malaria_2021/git_repos/mres-malaria-gene-expression/Tables/')
for (clst in cluster_ids){
clst_genes <- clusters[groups == clst]$gene_id
neg_clst_genes <- all_genes_gff[!all_genes_gff$gene_id %in% clst_genes]
write.table(neg_clst_genes, file=paste("neg_clst", clst, ".gff", sep =''), row.names = FALSE, col.names = FALSE, sep= '\t', quote= FALSE)
}
View(neg_clst_genes)
